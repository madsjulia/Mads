\documentclass[11pt]{article}

    \usepackage[breakable]{tcolorbox}
    \usepackage{parskip} % Stop auto-indenting (to mimic markdown behaviour)
    
    \usepackage{iftex}
    \ifPDFTeX
    	\usepackage[T1]{fontenc}
    	\usepackage{mathpazo}
    \else
    	\usepackage{fontspec}
    \fi

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % Maintain compatibility with old templates. Remove in nbconvert 6.0
    \let\Oldincludegraphics\includegraphics
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionFormat{nocaption}{}
    \captionsetup{format=nocaption,aboveskip=0pt,belowskip=0pt}

    \usepackage{float}
    \floatplacement{figure}{H} % forces figures to be placed at the correct location
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro
    \usepackage[mathletters]{ucs} % Extended unicode (utf-8) support
    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics 
                         % to support a larger range
    \makeatletter % fix for old versions of grffile with XeLaTeX
    \@ifpackagelater{grffile}{2019/11/01}
    {
      % Do nothing on new versions
    }
    {
      \def\Gread@@xetex#1{%
        \IfFileExists{"\Gin@base".bb}%
        {\Gread@eps{\Gin@base.bb}}%
        {\Gread@@xetex@aux#1}%
      }
    }
    \makeatother
    \usepackage[Export]{adjustbox} % Used to constrain images to a maximum size
    \adjustboxset{max size={0.9\linewidth}{0.9\paperheight}}

    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    % The default LaTeX title has an obnoxious amount of whitespace. By default,
    % titling removes some of it. It also provides customization options.
    \usepackage{titling}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    \usepackage{mathrsfs}
    

    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}
    \definecolor{ansi-default-inverse-fg}{HTML}{FFFFFF}
    \definecolor{ansi-default-inverse-bg}{HTML}{000000}

    % common color for the border for error outputs.
    \definecolor{outerrorbackground}{HTML}{FFDFDF}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}
    
    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    
    
    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatibility definitions
    \def\gt{>}
    \def\lt{<}
    \let\Oldtex\TeX
    \let\Oldlatex\LaTeX
    \renewcommand{\TeX}{\textrm{\Oldtex}}
    \renewcommand{\LaTeX}{\textrm{\Oldlatex}}
    % Document parameters
    % Document title
    \title{model\_diagnostics}
    
    
    
    
    
% Pygments definitions
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\@namedef{PY@tok@w}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\@namedef{PY@tok@c}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\@namedef{PY@tok@cp}{\def\PY@tc##1{\textcolor[rgb]{0.74,0.48,0.00}{##1}}}
\@namedef{PY@tok@k}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kp}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kt}{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\@namedef{PY@tok@o}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@ow}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\@namedef{PY@tok@nb}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@nf}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\@namedef{PY@tok@nc}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\@namedef{PY@tok@nn}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\@namedef{PY@tok@ne}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.82,0.25,0.23}{##1}}}
\@namedef{PY@tok@nv}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@no}{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\@namedef{PY@tok@nl}{\def\PY@tc##1{\textcolor[rgb]{0.63,0.63,0.00}{##1}}}
\@namedef{PY@tok@ni}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.60,0.60,0.60}{##1}}}
\@namedef{PY@tok@na}{\def\PY@tc##1{\textcolor[rgb]{0.49,0.56,0.16}{##1}}}
\@namedef{PY@tok@nt}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@nd}{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\@namedef{PY@tok@s}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@sd}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@si}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\@namedef{PY@tok@se}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.13}{##1}}}
\@namedef{PY@tok@sr}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\@namedef{PY@tok@ss}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@sx}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@m}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@gh}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\@namedef{PY@tok@gu}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\@namedef{PY@tok@gd}{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\@namedef{PY@tok@gi}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\@namedef{PY@tok@gr}{\def\PY@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\@namedef{PY@tok@ge}{\let\PY@it=\textit}
\@namedef{PY@tok@gs}{\let\PY@bf=\textbf}
\@namedef{PY@tok@gp}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\@namedef{PY@tok@go}{\def\PY@tc##1{\textcolor[rgb]{0.53,0.53,0.53}{##1}}}
\@namedef{PY@tok@gt}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\@namedef{PY@tok@err}{\def\PY@bc##1{{\setlength{\fboxsep}{\string -\fboxrule}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}}
\@namedef{PY@tok@kc}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kd}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kn}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kr}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@bp}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@fm}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\@namedef{PY@tok@vc}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@vg}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@vi}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@vm}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@sa}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@sb}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@sc}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@dl}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@s2}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@sh}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@s1}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@mb}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@mf}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@mh}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@mi}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@il}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@mo}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@ch}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\@namedef{PY@tok@cm}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\@namedef{PY@tok@cpf}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\@namedef{PY@tok@c1}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\@namedef{PY@tok@cs}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % For linebreaks inside Verbatim environment from package fancyvrb. 
    \makeatletter
        \newbox\Wrappedcontinuationbox 
        \newbox\Wrappedvisiblespacebox 
        \newcommand*\Wrappedvisiblespace {\textcolor{red}{\textvisiblespace}} 
        \newcommand*\Wrappedcontinuationsymbol {\textcolor{red}{\llap{\tiny$\m@th\hookrightarrow$}}} 
        \newcommand*\Wrappedcontinuationindent {3ex } 
        \newcommand*\Wrappedafterbreak {\kern\Wrappedcontinuationindent\copy\Wrappedcontinuationbox} 
        % Take advantage of the already applied Pygments mark-up to insert 
        % potential linebreaks for TeX processing. 
        %        {, <, #, %, $, ' and ": go to next line. 
        %        _, }, ^, &, >, - and ~: stay at end of broken line. 
        % Use of \textquotesingle for straight quote. 
        \newcommand*\Wrappedbreaksatspecials {% 
            \def\PYGZus{\discretionary{\char`\_}{\Wrappedafterbreak}{\char`\_}}% 
            \def\PYGZob{\discretionary{}{\Wrappedafterbreak\char`\{}{\char`\{}}% 
            \def\PYGZcb{\discretionary{\char`\}}{\Wrappedafterbreak}{\char`\}}}% 
            \def\PYGZca{\discretionary{\char`\^}{\Wrappedafterbreak}{\char`\^}}% 
            \def\PYGZam{\discretionary{\char`\&}{\Wrappedafterbreak}{\char`\&}}% 
            \def\PYGZlt{\discretionary{}{\Wrappedafterbreak\char`\<}{\char`\<}}% 
            \def\PYGZgt{\discretionary{\char`\>}{\Wrappedafterbreak}{\char`\>}}% 
            \def\PYGZsh{\discretionary{}{\Wrappedafterbreak\char`\#}{\char`\#}}% 
            \def\PYGZpc{\discretionary{}{\Wrappedafterbreak\char`\%}{\char`\%}}% 
            \def\PYGZdl{\discretionary{}{\Wrappedafterbreak\char`\$}{\char`\$}}% 
            \def\PYGZhy{\discretionary{\char`\-}{\Wrappedafterbreak}{\char`\-}}% 
            \def\PYGZsq{\discretionary{}{\Wrappedafterbreak\textquotesingle}{\textquotesingle}}% 
            \def\PYGZdq{\discretionary{}{\Wrappedafterbreak\char`\"}{\char`\"}}% 
            \def\PYGZti{\discretionary{\char`\~}{\Wrappedafterbreak}{\char`\~}}% 
        } 
        % Some characters . , ; ? ! / are not pygmentized. 
        % This macro makes them "active" and they will insert potential linebreaks 
        \newcommand*\Wrappedbreaksatpunct {% 
            \lccode`\~`\.\lowercase{\def~}{\discretionary{\hbox{\char`\.}}{\Wrappedafterbreak}{\hbox{\char`\.}}}% 
            \lccode`\~`\,\lowercase{\def~}{\discretionary{\hbox{\char`\,}}{\Wrappedafterbreak}{\hbox{\char`\,}}}% 
            \lccode`\~`\;\lowercase{\def~}{\discretionary{\hbox{\char`\;}}{\Wrappedafterbreak}{\hbox{\char`\;}}}% 
            \lccode`\~`\:\lowercase{\def~}{\discretionary{\hbox{\char`\:}}{\Wrappedafterbreak}{\hbox{\char`\:}}}% 
            \lccode`\~`\?\lowercase{\def~}{\discretionary{\hbox{\char`\?}}{\Wrappedafterbreak}{\hbox{\char`\?}}}% 
            \lccode`\~`\!\lowercase{\def~}{\discretionary{\hbox{\char`\!}}{\Wrappedafterbreak}{\hbox{\char`\!}}}% 
            \lccode`\~`\/\lowercase{\def~}{\discretionary{\hbox{\char`\/}}{\Wrappedafterbreak}{\hbox{\char`\/}}}% 
            \catcode`\.\active
            \catcode`\,\active 
            \catcode`\;\active
            \catcode`\:\active
            \catcode`\?\active
            \catcode`\!\active
            \catcode`\/\active 
            \lccode`\~`\~ 	
        }
    \makeatother

    \let\OriginalVerbatim=\Verbatim
    \makeatletter
    \renewcommand{\Verbatim}[1][1]{%
        %\parskip\z@skip
        \sbox\Wrappedcontinuationbox {\Wrappedcontinuationsymbol}%
        \sbox\Wrappedvisiblespacebox {\FV@SetupFont\Wrappedvisiblespace}%
        \def\FancyVerbFormatLine ##1{\hsize\linewidth
            \vtop{\raggedright\hyphenpenalty\z@\exhyphenpenalty\z@
                \doublehyphendemerits\z@\finalhyphendemerits\z@
                \strut ##1\strut}%
        }%
        % If the linebreak is at a space, the latter will be displayed as visible
        % space at end of first line, and a continuation symbol starts next line.
        % Stretch/shrink are however usually zero for typewriter font.
        \def\FV@Space {%
            \nobreak\hskip\z@ plus\fontdimen3\font minus\fontdimen4\font
            \discretionary{\copy\Wrappedvisiblespacebox}{\Wrappedafterbreak}
            {\kern\fontdimen2\font}%
        }%
        
        % Allow breaks at special characters using \PYG... macros.
        \Wrappedbreaksatspecials
        % Breaks at punctuation characters . , ; ? ! and / need catcode=\active 	
        \OriginalVerbatim[#1,codes*=\Wrappedbreaksatpunct]%
    }
    \makeatother

    % Exact colors from NB
    \definecolor{incolor}{HTML}{303F9F}
    \definecolor{outcolor}{HTML}{D84315}
    \definecolor{cellborder}{HTML}{CFCFCF}
    \definecolor{cellbackground}{HTML}{F7F7F7}
    
    % prompt
    \makeatletter
    \newcommand{\boxspacing}{\kern\kvtcb@left@rule\kern\kvtcb@boxsep}
    \makeatother
    \newcommand{\prompt}[4]{
        {\ttfamily\llap{{\color{#2}[#3]:\hspace{3pt}#4}}\vspace{-\baselineskip}}
    }
    

    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy 
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

\begin{document}
    
    \maketitle
    
    

    
    \hypertarget{mads-notebook-model-diagnostics}{%
\section{Mads notebook: Model
diagnostics}\label{mads-notebook-model-diagnostics}}

\href{http://madsjulia.github.io/Mads.jl}{MADS} is an integrated
high-performance computational framework for data/model/decision
analyses.

\begin{verbatim}
<img src="../../logo/mads_black_swan_logo_big_text_new_3inch.png" alt="MADS" width=20% max-width=125px;/>
\end{verbatim}

\href{http://madsjulia.github.io/Mads.jl}{MADS} can be applied to
perform:

\begin{itemize}
\tightlist
\item
  Sensitivity Analysis
\item
  Parameter Estimation
\item
  Model Inversion and Calibration
\item
  Uncertainty Quantification
\item
  Model Selection and Model Averaging
\item
  Model Reduction and Surrogate Modeling
\item
  Machine Learning (e.g., Blind Source Separation, Source
  Identification, Feature Extraction, Matrix / Tensor Factorization,
  etc.)
\item
  Decision Analysis and Support
\end{itemize}

Here, it is demonstrated how
\href{http://madsjulia.github.io/Mads.jl}{MADS} can be applied to solve
a general model diagnostic problem.

\hypertarget{problem-setup}{%
\subsection{Problem setup}\label{problem-setup}}

Import Mads (if \textbf{MADS} is not installed, first execute in the
Julia REPL: \texttt{import\ Pkg;\ Pkg.add("Mads")}):

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{1}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{Pkg}\PY{o}{.}\PY{n}{resolve}\PY{p}{(}\PY{p}{)}
\PY{k}{import} \PY{n}{Revise}
\PY{k}{import} \PY{n}{Mads}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
┌ Info: Precompiling Mads [d6bdc55b-bd94-5012-933c-1f73fc2ee992]
└ @ Base loading.jl:1317
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
\textbf{Mads: Model Analysis \& Decision Support}
====

\textcolor{ansi-blue-intense}{\textbf{    \_\_\_      \_\_\_\_    }}\textcolor{ansi-red-intense}{\textbf{        \_\_\_\_   }}\textcolor{ansi-green-intense}{\textbf{ \_\_\_\_
}}\textcolor{ansi-magenta-intense}{\textbf{     \_\_\_\_\_\_}}
\textcolor{ansi-blue-intense}{\textbf{   /   \textbackslash{}    /    \textbackslash{}  }}\textcolor{ansi-red-intense}{\textbf{        /    | }}\textcolor{ansi-green-intense}{\textbf{ |    \textbackslash{}
}}\textcolor{ansi-magenta-intense}{\textbf{       /  \_\_  \textbackslash{}}}
\textcolor{ansi-blue-intense}{\textbf{  |     \textbackslash{}  /     |   }}\textcolor{ansi-red-intense}{\textbf{      /     |  }}\textcolor{ansi-green-intense}{\textbf{|     \textbackslash{}
}}\textcolor{ansi-magenta-intense}{\textbf{     /  /  \textbackslash{}\_\_\textbackslash{}}}
\textcolor{ansi-blue-intense}{\textbf{  |  |\textbackslash{}  \textbackslash{}/  /|  | }}\textcolor{ansi-red-intense}{\textbf{       /      | }}\textcolor{ansi-green-intense}{\textbf{ |      \textbackslash{}
}}\textcolor{ansi-magenta-intense}{\textbf{     |  |}}
\textcolor{ansi-blue-intense}{\textbf{  |  | \textbackslash{}    / |  |  }}\textcolor{ansi-red-intense}{\textbf{     /  /|   | }}\textcolor{ansi-green-intense}{\textbf{ |   |\textbackslash{}  \textbackslash{}
}}\textcolor{ansi-magenta-intense}{\textbf{     \textbackslash{}  \textbackslash{}\_\_\_\_\_\_.}}
\textcolor{ansi-blue-intense}{\textbf{  |  |  \textbackslash{}\_\_/  |  |  }}\textcolor{ansi-red-intense}{\textbf{    /  / |   | }}\textcolor{ansi-green-intense}{\textbf{ |   | \textbackslash{}  \textbackslash{}
}}\textcolor{ansi-magenta-intense}{\textbf{      \textbackslash{}\_\_\_\_\_\_\_  \textbackslash{}}}
\textcolor{ansi-blue-intense}{\textbf{  |  |        |  | }}\textcolor{ansi-red-intense}{\textbf{    /  /  |   | }}\textcolor{ansi-green-intense}{\textbf{ |   |  \textbackslash{}  \textbackslash{}
}}\textcolor{ansi-magenta-intense}{\textbf{             \textbackslash{}  \textbackslash{}}}
\textcolor{ansi-blue-intense}{\textbf{  |  |        |  |  }}\textcolor{ansi-red-intense}{\textbf{  /  /===|   | }}\textcolor{ansi-green-intense}{\textbf{ |   |\_\_\_\textbackslash{}  \textbackslash{}
}}\textcolor{ansi-magenta-intense}{\textbf{   \_\_.        |  |}}
\textcolor{ansi-blue-intense}{\textbf{  |  |        |  | }}\textcolor{ansi-red-intense}{\textbf{  /  /    |   | }}\textcolor{ansi-green-intense}{\textbf{ |           \textbackslash{}
}}\textcolor{ansi-magenta-intense}{\textbf{ \textbackslash{}  \textbackslash{}\_\_\_\_\_\_/  /}}
\textcolor{ansi-blue-intense}{\textbf{  |\_\_|        |\_\_| }}\textcolor{ansi-red-intense}{\textbf{ /\_\_/     |\_\_\_| }}\textcolor{ansi-green-intense}{\textbf{ |\_\_\_\_\_\_\_\_\_\_\_\_\textbackslash{}
}}\textcolor{ansi-magenta-intense}{\textbf{  \textbackslash{}\_\_\_\_\_\_\_\_\_\_/}}

\textbf{MADS} is an integrated high-performance computational framework for data-
and model-based analyses.
\textbf{MADS} can perform: Sensitivity Analysis, Parameter Estimation, Model
Inversion and Calibration, Uncertainty Quantification, Model Selection and Model
Averaging, Model Reduction and Surrogate Modeling, Machine Learning, Decision
Analysis and Support.
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
\textcolor{ansi-green-intense}{\textbf{    Updating}} registry at `\textasciitilde{}/.julia/registries/General`
\textcolor{ansi-yellow-intense}{\textbf{┌ }}\textcolor{ansi-yellow-intense}{\textbf{Warning: }}could not download
https://pkg.julialang.org/registries
\textcolor{ansi-yellow-intense}{\textbf{└ }}\textcolor{ansi-black-intense}{@ Pkg.Types /Users/julia/buildbot/worker/package\_macos
64/build/usr/share/julia/stdlib/v1.6/Pkg/src/Types.jl:980}
\textcolor{ansi-green-intense}{\textbf{   Resolving}} package versions{\ldots}
\textcolor{ansi-cyan-intense}{\textbf{[ }}\textcolor{ansi-cyan-intense}{\textbf{Info: }}Module BIGUQ is not available!
┌ Info: Installing pyqt package to avoid buggy tkagg backend.
└ @ PyPlot /Users/vvv/.julia/packages/PyPlot/XHEG0/src/init.jl:118
    \end{Verbatim}

    Setup the working directory:

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{2}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{cd}\PY{p}{(}\PY{n}{joinpath}\PY{p}{(}\PY{n}{Mads}\PY{o}{.}\PY{n}{madsdir}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{notebooks}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{model\PYZus{}diagnostics}\PY{l+s}{\PYZdq{}}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    Create a problem dictionary:

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{3}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{md} \PY{o}{=} \PY{k+kt}{Dict}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{3}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
Dict\{Any, Any\}()
\end{Verbatim}
\end{tcolorbox}
        
    Setup model parameters:

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{4}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{md}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{Parameters}\PY{l+s}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{Mads}\PY{o}{.}\PY{n}{createparameters}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{;} \PY{n}{key}\PY{o}{=}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{a}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{b}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{c}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{n}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{,} \PY{n}{dist}\PY{o}{=}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{Uniform(\PYZhy{}10, 10)}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{Uniform(\PYZhy{}10, 10)}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{Uniform(\PYZhy{}5, 5)}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{Uniform(0, 3)}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{4}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
OrderedCollections.OrderedDict\{Any, Any\} with 4 entries:
  "a" => OrderedCollections.OrderedDict\{String, Any\}("init"=>1, "type"=>"opt", …
  "b" => OrderedCollections.OrderedDict\{String, Any\}("init"=>1, "type"=>"opt", …
  "c" => OrderedCollections.OrderedDict\{String, Any\}("init"=>1, "type"=>"opt", …
  "n" => OrderedCollections.OrderedDict\{String, Any\}("init"=>1, "type"=>"opt", …
\end{Verbatim}
\end{tcolorbox}
        
    There are 4 model parameters (\texttt{a}, \texttt{b}, \texttt{c}, and
\texttt{n}). The initial values and the prior distributions (based on
prior knowledge of the parameter uncertainty) are defined for each
parameter.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{5}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{md}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{Observations}\PY{l+s}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{n}{Mads}\PY{o}{.}\PY{n}{createobservations}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mf}{1.1}\PY{p}{,}\PY{l+m+mf}{1.9}\PY{p}{,}\PY{l+m+mf}{3.1}\PY{p}{,}\PY{l+m+mf}{3.9}\PY{p}{,}\PY{l+m+mi}{5}\PY{p}{]}\PY{p}{;} \PY{n}{weight}\PY{o}{=}\PY{p}{[}\PY{l+m+mi}{100}\PY{p}{,}\PY{l+m+mi}{100}\PY{p}{,}\PY{l+m+mi}{100}\PY{p}{,}\PY{l+m+mi}{100}\PY{p}{,}\PY{l+m+mi}{10}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,} \PY{n}{time}\PY{o}{=}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{4}\PY{p}{,}\PY{l+m+mi}{5}\PY{p}{]}\PY{p}{,} \PY{n}{dist}\PY{o}{=}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{Uniform(0, 1)}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{Uniform(0, 2)}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{Uniform(1, 3)}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{Uniform(2, 4)}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{Uniform(3, 5)}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{Uniform(4, 6)}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
dist = ["Uniform(0, 1)", "Uniform(0, 2)", "Uniform(1, 3)", "Uniform(2, 4)",
"Uniform(3, 5)", "Uniform(4, 6)"]
    \end{Verbatim}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{5}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
OrderedCollections.OrderedDict\{Any, Any\} with 6 entries:
  "o1" => OrderedCollections.OrderedDict\{String, Any\}("target"=>0.0, "weight"=>…
  "o2" => OrderedCollections.OrderedDict\{String, Any\}("target"=>1.1, "weight"=>…
  "o3" => OrderedCollections.OrderedDict\{String, Any\}("target"=>1.9, "weight"=>…
  "o4" => OrderedCollections.OrderedDict\{String, Any\}("target"=>3.1, "weight"=>…
  "o5" => OrderedCollections.OrderedDict\{String, Any\}("target"=>3.9, "weight"=>…
  "o6" => OrderedCollections.OrderedDict\{String, Any\}("target"=>5.0, "weight"=>…
\end{Verbatim}
\end{tcolorbox}
        
    There are 6 observations (\texttt{o1}, \texttt{o2}, \texttt{o3},
\ldots{} and \texttt{o6}). The calibration targets, observation weights
(i.e., inverse of measurement standard deviations), and acceptable
ranges are defined for each observation.

    A function (called \texttt{polynomial}) is defined to compute the 6
observations given 4 model parameters as an input:

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{6}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{function} \PY{n}{polynomial}\PY{p}{(}\PY{n}{parameters}\PY{o}{::}\PY{k+kt}{AbstractVector}\PY{p}{)}
	\PY{n}{f}\PY{p}{(}\PY{n}{t}\PY{p}{)} \PY{o}{=} \PY{n}{parameters}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{*} \PY{p}{(}\PY{n}{t} \PY{o}{\PYZca{}} \PY{n}{parameters}\PY{p}{[}\PY{l+m+mi}{4}\PY{p}{]}\PY{p}{)} \PY{o}{+} \PY{n}{parameters}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]} \PY{o}{*} \PY{n}{t} \PY{o}{+} \PY{n}{parameters}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{]} \PY{c}{\PYZsh{} a * t\PYZca{}n + b * t + c}
	\PY{n}{predictions} \PY{o}{=} \PY{n}{map}\PY{p}{(}\PY{n}{f}\PY{p}{,} \PY{l+m+mi}{0}\PY{o}{:}\PY{l+m+mi}{5}\PY{p}{)}
	\PY{k}{return} \PY{n}{predictions}
\PY{k}{end}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{6}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
polynominal (generic function with 1 method)
\end{Verbatim}
\end{tcolorbox}
        
    The \texttt{polynomial} function is setup now in the \texttt{md}
dictionary as a model that will be applied to perform the simulations:

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{7}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{Mads}\PY{o}{.}\PY{n}{setmodel!}\PY{p}{(}\PY{n}{md}\PY{p}{,} \PY{n}{polynomial}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{7}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
(::Mads.var"\#madscommandfunctionwithexpressions\#18") (generic function with 1
method)
\end{Verbatim}
\end{tcolorbox}
        
    Set a default name for MADS input / output files:

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{8}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{md}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{Filename}\PY{l+s}{\PYZdq{}}\PY{p}{]} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{model\PYZus{}diagnostics.mads}\PY{l+s}{\PYZdq{}}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{8}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
"model\_diagnostics.mads"
\end{Verbatim}
\end{tcolorbox}
        
    Now, the problem dictionary \texttt{md} is fully defined:

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{9}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{display}\PY{p}{(}\PY{n}{md}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    
    \begin{Verbatim}[commandchars=\\\{\}]
Dict\{Any, Any\} with 4 entries:
  "Julia function" => polynominal
  "Parameters"     => OrderedCollections.OrderedDict\{Any, Any\}("a"=>OrderedColl…
  "Observations"   => OrderedCollections.OrderedDict\{Any, Any\}("o1"=>OrderedCol…
  "Filename"       => "model\_diagnostics.mads"
    \end{Verbatim}

    
    And the model diagnostic problem is setup!

    \hypertarget{forward-model-simulation}{%
\subsection{Forward model simulation}\label{forward-model-simulation}}

    A single forward model run based on the initial model parameter values
can be executed as follows:

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{10}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{Mads}\PY{o}{.}\PY{n}{forward}\PY{p}{(}\PY{n}{md}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{10}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
OrderedCollections.OrderedDict\{Any, Float64\} with 6 entries:
  "o1" => 1.0
  "o2" => 3.0
  "o3" => 5.0
  "o4" => 7.0
  "o5" => 9.0
  "o6" => 11.0
\end{Verbatim}
\end{tcolorbox}
        
    The forward model run can be also executed using the following command:

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{11}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{polynomial}\PY{p}{(}\PY{n}{Mads}\PY{o}{.}\PY{n}{getparamsinit}\PY{p}{(}\PY{n}{md}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{11}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
6-element Vector\{Float64\}:
  1.0
  3.0
  5.0
  7.0
  9.0
 11.0
\end{Verbatim}
\end{tcolorbox}
        
    The runs above produce outputs representing model predictions at the six
observations in time.

The forward simulations are based on the initial guesses for the model
parameters.

The initial model predictions can be plotted as shown below:

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{12}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{Mads}\PY{o}{.}\PY{n}{plotmatches}\PY{p}{(}\PY{n}{md}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{model_diagnostics_files/model_diagnostics_26_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]

    \end{Verbatim}

    The figure above shows that the \texttt{true} observations are not well
reproduced by the model using the initial model parameter guesses.

    \hypertarget{model-calibration-inversion}{%
\subsection{Model calibration
(inversion)}\label{model-calibration-inversion}}

    The calibation (inversion) of the developed model is achieved using the
following command:

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{13}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{calib\PYZus{}param}\PY{p}{,} \PY{n}{calib\PYZus{}result} \PY{o}{=} \PY{n}{Mads}\PY{o}{.}\PY{n}{calibrate}\PY{p}{(}\PY{n}{md}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{13}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
(OrderedCollections.OrderedDict("a" => 0.0070504634932362364, "b" =>
0.9506900793467459, "c" => 0.03854153288467277, "n" => 2.9321887287806576),
OptimBase.MultivariateOptimizationResults\{LsqFit.LevenbergMarquardt, Float64,
1\}(LsqFit.LevenbergMarquardt(), [0.10016742116155988, 0.10016742116155988,
0.20135792079033074, -0.339836909454122], [-31.415221489490197,
31.51113933688991, 0.007708382914323126, 33.28855825149693], 233.37348475659584,
19, false, true, 0.0001, 0.0, false, 0.001, 0.0, false, 1.0e-6, 0.0, false, Iter
Function value   Gradient norm
------   --------------   --------------
, 267, 19, 0))
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{14}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{Mads}\PY{o}{.}\PY{n}{plotmatches}\PY{p}{(}\PY{n}{md}\PY{p}{,} \PY{n}{calib\PYZus{}param}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{model_diagnostics_files/model_diagnostics_31_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]

    \end{Verbatim}

    Initial values of the model parameters are:

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{15}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{Mads}\PY{o}{.}\PY{n}{showparameterestimates}\PY{p}{(}\PY{n}{md}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
a =               1 distribution = Uniform(-10, 10)
b =               1 distribution = Uniform(-10, 10)
c =               1 distribution = Uniform(-5, 5)
n =               1 distribution = Uniform(0, 3)
Number of optimizable parameters: 4
    \end{Verbatim}

    Estimated values of the model parameters based on the model calibration
(inversion) are:

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{16}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{Mads}\PY{o}{.}\PY{n}{showparameterestimates}\PY{p}{(}\PY{n}{md}\PY{p}{,} \PY{n}{calib\PYZus{}param}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
a =      0.00705046 distribution = Uniform(-10, 10)
b =         0.95069 distribution = Uniform(-10, 10)
c =       0.0385415 distribution = Uniform(-5, 5)
n =         2.93219 distribution = Uniform(0, 3)
Number of optimizable parameters: 4
    \end{Verbatim}

    The model inversion can be also performed for a set of random initial
guesses for model parameters.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{17}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{calib\PYZus{}random\PYZus{}results} \PY{o}{=} \PY{n}{Mads}\PY{o}{.}\PY{n}{calibraterandom}\PY{p}{(}\PY{n}{md}\PY{p}{,} \PY{l+m+mi}{100}\PY{p}{;} \PY{n}{seed}\PY{o}{=}\PY{l+m+mi}{2021}\PY{p}{,} \PY{n}{all}\PY{o}{=}\PY{n+nb}{true}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{17}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
100×3 Matrix\{Any\}:
  232.272  …  OrderedCollections.OrderedDict("a"=>0.00653517, "b"=>0.950689,
"c"=>0.039249, "n"=>3.0)
  270.314     OrderedCollections.OrderedDict("a"=>-0.28542, "b"=>1.27948,
"c"=>0.0178456, "n"=>0.951994)
  232.272     OrderedCollections.OrderedDict("a"=>0.00653398, "b"=>0.950704,
"c"=>0.0392286, "n"=>3.0)
  232.272     OrderedCollections.OrderedDict("a"=>0.00653436, "b"=>0.950702,
"c"=>0.0392321, "n"=>2.99998)
  232.272     OrderedCollections.OrderedDict("a"=>0.00653522, "b"=>0.950689,
"c"=>0.039249, "n"=>3.0)
  270.097  …  OrderedCollections.OrderedDict("a"=>-4.30065, "b"=>5.28695,
"c"=>0.0214167, "n"=>0.995285)
 7643.02      OrderedCollections.OrderedDict("a"=>-9.89624, "b"=>9.82224,
"c"=>0.622939, "n"=>0.910639)
  269.91      OrderedCollections.OrderedDict("a"=>-4.41759, "b"=>5.40692,
"c"=>0.0206894, "n"=>0.9961)
  270.093     OrderedCollections.OrderedDict("a"=>-4.82082, "b"=>5.80708,
"c"=>0.0214349, "n"=>0.995788)
  270.067     OrderedCollections.OrderedDict("a"=>-2.58655, "b"=>3.57364,
"c"=>0.0211371, "n"=>0.992455)
  269.929  …  OrderedCollections.OrderedDict("a"=>-3.36971, "b"=>4.3589,
"c"=>0.0207631, "n"=>0.994848)
  268.409     OrderedCollections.OrderedDict("a"=>0.0354613, "b"=>0.998702,
"c"=>1.70238e-5, "n"=>0.000376271)
  268.41      OrderedCollections.OrderedDict("a"=>0.0354481, "b"=>0.998704,
"c"=>2.21817e-5, "n"=>0.000448126)
    ⋮      ⋱
  232.272     OrderedCollections.OrderedDict("a"=>0.00653517, "b"=>0.950689,
"c"=>0.039249, "n"=>3.0)
  232.272     OrderedCollections.OrderedDict("a"=>0.00653522, "b"=>0.950689,
"c"=>0.039249, "n"=>3.0)
  232.272  …  OrderedCollections.OrderedDict("a"=>0.00653436, "b"=>0.950702,
"c"=>0.0392321, "n"=>2.99998)
  270.091     OrderedCollections.OrderedDict("a"=>-5.97129, "b"=>6.95745,
"c"=>0.0214664, "n"=>0.996586)
  270.122     OrderedCollections.OrderedDict("a"=>-2.481, "b"=>3.46755,
"c"=>0.0212952, "n"=>0.991901)
  269.794     OrderedCollections.OrderedDict("a"=>3.95245, "b"=>-2.96176,
"c"=>0.0197838, "n"=>1.00408)
  232.272     OrderedCollections.OrderedDict("a"=>0.00653517, "b"=>0.950689,
"c"=>0.039249, "n"=>3.0)
  232.272  …  OrderedCollections.OrderedDict("a"=>0.00653516, "b"=>0.950689,
"c"=>0.0392491, "n"=>3.0)
  270.802     OrderedCollections.OrderedDict("a"=>-0.121823, "b"=>1.11748,
"c"=>0.0170054, "n"=>0.896066)
  269.868     OrderedCollections.OrderedDict("a"=>0.962624, "b"=>0.0219806,
"c"=>0.0223074, "n"=>1.02225)
  270.09      OrderedCollections.OrderedDict("a"=>-5.46149, "b"=>6.44768,
"c"=>0.0214512, "n"=>0.996277)
  270.362     OrderedCollections.OrderedDict("a"=>-0.387051, "b"=>1.37691,
"c"=>0.0197667, "n"=>0.954846)
\end{Verbatim}
\end{tcolorbox}
        
    The final parameter estimates from the 100 random-initial-guess inverse
runs are collected into a matrix below:

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{18}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{calib\PYZus{}random\PYZus{}estimates} \PY{o}{=} \PY{n}{hcat}\PY{p}{(}\PY{n}{map}\PY{p}{(}\PY{n}{i}\PY{o}{\PYZhy{}\PYZgt{}}\PY{n}{collect}\PY{p}{(}\PY{n}{values}\PY{p}{(}\PY{n}{calib\PYZus{}random\PYZus{}results}\PY{p}{[}\PY{n}{i}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{]}\PY{p}{)}\PY{p}{)}\PY{p}{,} \PY{l+m+mi}{1}\PY{o}{:}\PY{l+m+mi}{100}\PY{p}{)}\PY{o}{...}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{18}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
4×100 Matrix\{Float64\}:
 0.00653517  -0.28542    0.00653398  …  0.962624   -5.46149    -0.387051
 0.950689     1.27948    0.950704       0.0219806   6.44768     1.37691
 0.039249     0.0178456  0.0392286      0.0223074   0.0214512   0.0197667
 3.0          0.951994   3.0            1.02225     0.996277    0.954846
\end{Verbatim}
\end{tcolorbox}
        
    Plot the final predictions of the 100 random-initial-guess inverse runs:

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{19}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{forward\PYZus{}predictions} \PY{o}{=} \PY{n}{Mads}\PY{o}{.}\PY{n}{forward}\PY{p}{(}\PY{n}{md}\PY{p}{,} \PY{n}{calib\PYZus{}random\PYZus{}estimates}\PY{p}{)}
\PY{n}{Mads}\PY{o}{.}\PY{n}{spaghettiplot}\PY{p}{(}\PY{n}{md}\PY{p}{,} \PY{n}{forward\PYZus{}predictions}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{model_diagnostics_files/model_diagnostics_41_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]

    \end{Verbatim}

    The figure above demonstrates that there are several different global
minima.

There are three important groups of results with different \texttt{n}
values: * \texttt{n} = 0 * \texttt{n} = 1 * \texttt{n} = 3 (upper prior
bound)

The code below identifies and plots solutions associated with these 3
distinct groups:

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{20}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{ind\PYZus{}n0} \PY{o}{=} \PY{n}{abs}\PY{o}{.}\PY{p}{(}\PY{n}{calib\PYZus{}random\PYZus{}estimates}\PY{p}{[}\PY{l+m+mi}{4}\PY{p}{,}\PY{o}{:}\PY{p}{]}\PY{p}{)} \PY{o}{.\PYZlt{}} \PY{l+m+mf}{0.1}
\PY{n}{in0} \PY{o}{=} \PY{n}{findall}\PY{p}{(}\PY{n}{ind\PYZus{}n0} \PY{o}{.==} \PY{n+nb}{true}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}
\PY{n}{ind\PYZus{}n1} \PY{o}{=} \PY{n}{abs}\PY{o}{.}\PY{p}{(}\PY{n}{calib\PYZus{}random\PYZus{}estimates}\PY{p}{[}\PY{l+m+mi}{4}\PY{p}{,}\PY{o}{:}\PY{p}{]} \PY{o}{.\PYZhy{}} \PY{l+m+mi}{1}\PY{p}{)} \PY{o}{.\PYZlt{}} \PY{l+m+mf}{0.1}
\PY{n}{in1} \PY{o}{=} \PY{n}{findall}\PY{p}{(}\PY{n}{ind\PYZus{}n1} \PY{o}{.==} \PY{n+nb}{true}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}
\PY{n}{ind\PYZus{}n3} \PY{o}{=} \PY{o}{.!}\PY{p}{(}\PY{n}{ind\PYZus{}n0} \PY{o}{.|} \PY{n}{ind\PYZus{}n1}\PY{p}{)}
\PY{n}{in3} \PY{o}{=} \PY{n}{findall}\PY{p}{(}\PY{n}{ind\PYZus{}n3} \PY{o}{.==} \PY{n+nb}{true}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}
\PY{n}{pinit} \PY{o}{=} \PY{k+kt}{Dict}\PY{p}{(}\PY{n}{zip}\PY{p}{(}\PY{n}{Mads}\PY{o}{.}\PY{n}{getparamkeys}\PY{p}{(}\PY{n}{md}\PY{p}{)}\PY{p}{,} \PY{n}{Mads}\PY{o}{.}\PY{n}{getparamsinit}\PY{p}{(}\PY{n}{md}\PY{p}{)}\PY{p}{)}\PY{p}{)}
\PY{n}{optnames} \PY{o}{=} \PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{n=0}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{n=1}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{n=3}\PY{l+s}{\PYZdq{}}\PY{p}{]}
\PY{n}{v} \PY{o}{=} \PY{p}{[}\PY{n}{in0}\PY{p}{,} \PY{n}{in1}\PY{p}{,} \PY{n}{in3}\PY{p}{]}

\PY{k}{for} \PY{n}{i} \PY{o}{=} \PY{l+m+mi}{1}\PY{o}{:}\PY{l+m+mi}{3}
	\PY{n}{println}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{Solution for }\PY{l+s+si}{\PYZdl{}}\PY{p}{(}\PY{n}{optnames}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}\PY{l+s}{\PYZdq{}}\PY{p}{)}
	\PY{n}{Mads}\PY{o}{.}\PY{n}{showparameters}\PY{p}{(}\PY{n}{md}\PY{p}{,} \PY{n}{calib\PYZus{}random\PYZus{}results}\PY{p}{[}\PY{n}{v}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{]}\PY{p}{)}
	\PY{n}{Mads}\PY{o}{.}\PY{n}{plotmatches}\PY{p}{(}\PY{n}{md}\PY{p}{,} \PY{n}{calib\PYZus{}random\PYZus{}results}\PY{p}{[}\PY{n}{v}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{]}\PY{p}{;} \PY{n}{title}\PY{o}{=}\PY{n}{optnames}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}
\PY{k}{end}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{model_diagnostics_files/model_diagnostics_43_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
Solution for n=0
a =       0.0354613 distribution = Uniform(-10, 10)
b =        0.998702 distribution = Uniform(-10, 10)
c =     1.70238e-05 distribution = Uniform(-5, 5)
n =     0.000376271 distribution = Uniform(0, 3)
Number of optimizable parameters: 4
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{model_diagnostics_files/model_diagnostics_43_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{model_diagnostics_files/model_diagnostics_43_3.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
Solution for n=1
a =        -0.28542 distribution = Uniform(-10, 10)
b =         1.27948 distribution = Uniform(-10, 10)
c =       0.0178456 distribution = Uniform(-5, 5)
n =        0.951994 distribution = Uniform(0, 3)
Number of optimizable parameters: 4
Solution for n=3
a =      0.00653517 distribution = Uniform(-10, 10)
b =        0.950689 distribution = Uniform(-10, 10)
c =        0.039249 distribution = Uniform(-5, 5)
n =               3 distribution = Uniform(0, 3)
Number of optimizable parameters: 4
    \end{Verbatim}

    \hypertarget{evaluation-of-predictive-sensitivities-and-uncertainties}{%
\subsection{Evaluation of predictive sensitivities and
uncertainties}\label{evaluation-of-predictive-sensitivities-and-uncertainties}}

    \hypertarget{local-sensitivity-and-uncertainty-quantification}{%
\subsubsection{Local sensitivity and uncertainty
quantification}\label{local-sensitivity-and-uncertainty-quantification}}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{21}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{localsa} \PY{o}{=} \PY{n}{Mads}\PY{o}{.}\PY{n}{localsa}\PY{p}{(}\PY{n}{md}\PY{p}{;} \PY{n}{filename}\PY{o}{=}\PY{l+s}{\PYZdq{}}\PY{l+s}{model\PYZus{}diagnostics.png}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{n}{par}\PY{o}{=}\PY{n}{collect}\PY{p}{(}\PY{n}{values}\PY{p}{(}\PY{n}{calib\PYZus{}param}\PY{p}{)}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{21}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
Dict\{String, Any\} with 6 entries:
  "of"          => 233.373
  "jacobian"    => [0.0 0.0 498.96 0.0; 998.299 989.063 498.96 0.0; … ; 5815.86…
  "covar"       => [9.60666e-7 -1.96149e-6 6.59975e-7 -0.00248792; -1.96149e-6 …
  "eigenmatrix" => [-0.99148 0.126137 0.0324964 0.000380915; -0.128081 -0.89869…
  "eigenvalues" => [1.36761e-9, 4.44737e-7, 4.31592e-6, 6.53143]
  "stddev"      => [0.000980135, 0.00217703, 0.00198921, 2.55567]
\end{Verbatim}
\end{tcolorbox}
        
    

    \texttt{localsa{[}"stddev"{]}} defines the estimated posterior
uncertainties in the estimated model parameters. This estimate is based
on the Jacobian / Hessian matrix estimates of the parameter space
curvature in the vicinity the estimated (inverted) optimal parameters.
The uncertainties are assumed to be Gaussian with standard deviations
defined by \texttt{localsa{[}"stddev"{]}}.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{22}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{p}{[}\PY{n}{Mads}\PY{o}{.}\PY{n}{getparamlabels}\PY{p}{(}\PY{n}{md}\PY{p}{)} \PY{n}{localsa}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{stddev}\PY{l+s}{\PYZdq{}}\PY{p}{]}\PY{p}{]}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{22}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
4×2 Matrix\{Any\}:
 "a"  0.000980135
 "b"  0.00217703
 "c"  0.00198921
 "n"  2.55567
\end{Verbatim}
\end{tcolorbox}
        
    Based on these results, \texttt{c} is well constrained. \texttt{n} is
also well defined. \texttt{a} and \texttt{b} are the most uncertain.

However, because of the local nature of the estimates these results are
not very accurate and differ with the global sensitivity and uncertainty
analyses presented below.

The plots below show a series of graphical representations of the
\texttt{localsa} results. These plots are generated automatically by the
code.

A plot of the Jacobian representing the relationships between model
parameters and estimated observations:

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{23}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{Mads}\PY{o}{.}\PY{n}{display}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{model\PYZus{}diagnostics\PYZhy{}jacobian.png}\PY{l+s}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
┌ Info: Precompiling PNGFiles [f57f5aa1-a3ce-4bc8-8ab9-96f992907883]
└ @ Base loading.jl:1317
    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{model_diagnostics_files/model_diagnostics_51_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]

    \end{Verbatim}

    A plot of the eigen matrix of the Hessian (the Hessian is approximately
computed based on the Jacobian above):

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{24}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{Mads}\PY{o}{.}\PY{n}{display}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{model\PYZus{}diagnostics\PYZhy{}eigenmatrix.png}\PY{l+s}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{model_diagnostics_files/model_diagnostics_53_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]

    \end{Verbatim}

    A plot of the eigen values of the Hessian:

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{25}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{Mads}\PY{o}{.}\PY{n}{display}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{model\PYZus{}diagnostics\PYZhy{}eigenvalues.png}\PY{l+s}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{model_diagnostics_files/model_diagnostics_55_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]

    \end{Verbatim}

    The eigen analysis presetned above suggest that \texttt{a} and
\texttt{b} are correlated (this is expected based on the mathematical
form of the solved model in the function \texttt{polynomial}). Both
parameters are represented by the first and last (4th) eigen vectors.

The parameters \texttt{n} and \texttt{c} are uncorrelated and also
independent of \texttt{a} and \texttt{b}.

    \hypertarget{global-sensitivity-and-uncertainty-quantification}{%
\subsection{Global sensitivity and uncertainty
quantification}\label{global-sensitivity-and-uncertainty-quantification}}

    \hypertarget{affine-invariant-mcmc}{%
\subsubsection{Affine Invariant MCMC}\label{affine-invariant-mcmc}}

Our module \texttt{AffineInvariantMCMC.jl} (aka \texttt{EMCEE}) is
applied to perform global sensitivity and uncertainty quantification:

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{26}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{chain}\PY{p}{,} \PY{n}{llhoods} \PY{o}{=} \PY{n}{Mads}\PY{o}{.}\PY{n}{emceesampling}\PY{p}{(}\PY{n}{md}\PY{p}{;} \PY{n}{numwalkers}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{,} \PY{n}{nsteps}\PY{o}{=}\PY{l+m+mi}{100000}\PY{p}{,} \PY{n}{burnin}\PY{o}{=}\PY{l+m+mi}{10000}\PY{p}{,} \PY{n}{thinning}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{,} \PY{n}{seed}\PY{o}{=}\PY{l+m+mi}{2016}\PY{p}{,} \PY{n}{sigma}\PY{o}{=}\PY{l+m+mf}{0.01}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{26}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
([0.49024400617534947 0.6254729606781848 … -8.046148738315333
-2.1961730184742825; 0.6481371331360766 0.5032929504742999 … 9.11821705704645
3.2649675439015318; -0.0892523408443533 -0.17549509446712216 …
-0.02937423101178159 0.02857674237214133; 0.8301664734123894 0.9506210629622112
… 1.0109232316258625 1.0385261234145131], [-13.932168591704212,
-17.348618201269236, -12.63389804512083, -13.91533166749997,
-13.580439063638536, -12.966576797494277, -13.683861969420244,
-12.759294163171537, -12.514264566232404, -13.004554415413187  …
-14.013608226665623, -13.538985556025008, -13.092064136134097,
-14.227146487852597, -17.53945111529656, -13.317831924258758,
-16.05995385278711, -12.536985011850854, -15.022418530804252,
-13.952189155538974])
\end{Verbatim}
\end{tcolorbox}
        
    The obtained set of 10000 equally likely parameter combinations
capturing the global sensitivity and uncertainty of the model parameters
and associated predictions are plotted below.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{27}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{f} \PY{o}{=} \PY{n}{Mads}\PY{o}{.}\PY{n}{forward}\PY{p}{(}\PY{n}{md}\PY{p}{,} \PY{n}{chain}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{27}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
6×10000 Matrix\{Float64\}:
 -0.0892523  -0.175495  0.0521224  …  -0.0309209  -0.0293742  0.0285767
  1.04913     0.953271  1.02412        1.00445     1.04269    1.09737
  2.07862     2.03995   2.00473        2.01825     1.99246    2.04729
  3.07556     3.11172   2.98858        3.02342     2.89541    2.95011
  4.05291     4.17404   3.97454        4.02286     3.76782    3.82182
  5.01641     5.22941   4.96206    …   5.01799     4.61745    4.67012
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{28}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{Mads}\PY{o}{.}\PY{n}{spaghettiplot}\PY{p}{(}\PY{n}{md}\PY{p}{,} \PY{n}{f}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{model_diagnostics_files/model_diagnostics_62_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]

    \end{Verbatim}

    The figure above compares the 10000 model predictions with the actual
measurements (red dots).

The figure below shows the histograms of the posterior model
uncertainties (along the diagonal) and the cross-plots between the
parameters (off-diagonal plots; the cross-plots above and below the
diagonal are similar):

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{29}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{Mads}\PY{o}{.}\PY{n}{scatterplotsamples}\PY{p}{(}\PY{n}{md}\PY{p}{,} \PY{n}{permutedims}\PY{p}{(}\PY{n}{chain}\PY{p}{)}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{model\PYZus{}diagnostics\PYZhy{}emcee\PYZus{}scatter.png}\PY{l+s}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{30}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{Mads}\PY{o}{.}\PY{n}{display}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{model\PYZus{}diagnostics\PYZhy{}emcee\PYZus{}scatter.png}\PY{l+s}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{model_diagnostics_files/model_diagnostics_65_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]

    \end{Verbatim}

    The figure above shows that the optimal (most probable) estimates are: *
\texttt{a} = 0 * \texttt{b} = 1 * \texttt{c} = 0 * \texttt{n} = 0

\texttt{c} i the most constrained (varing between -0.2 and 0.2).

There are plausible solutions for any value of \texttt{a}, \texttt{b}
and \texttt{n} within the prior uncertainty range.

The parameters \texttt{a} and \texttt{b} are strongly inversely
correlated by their respective cross-plots.

Based on the cross-plots, the plausible values for \texttt{n} can be
within the entire prior uncertainty range if (1) \texttt{a} is equal to
0 and (2) \texttt{b} is equal to 1.

The plausible values for \texttt{n} are close to 1 if (1) \texttt{a} is
very different from 0 and (2) \texttt{b} is very different from 1.

    \hypertarget{saltelli-sobol-amd-efast-global-sensitivity-analyses}{%
\subsubsection{Saltelli (Sobol) amd EFAST global sensitivity
analyses}\label{saltelli-sobol-amd-efast-global-sensitivity-analyses}}

Both Saltelli (Sobol) amd EFAST methods are producing similar results.
Both methods are designed to perform global sensitivity analyses. EFAST
is computationally more efficient.

The Saltelli (Sobol) results are obtained as follows:

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{31}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{saltelli\PYZus{}results} \PY{o}{=} \PY{n}{Mads}\PY{o}{.}\PY{n}{saltelli}\PY{p}{(}\PY{n}{md}\PY{p}{,} \PY{n}{N}\PY{o}{=}\PY{l+m+mi}{10000}\PY{p}{,} \PY{n}{seed}\PY{o}{=}\PY{l+m+mi}{2016}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{31}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
Dict\{String, Any\} with 6 entries:
  "method"     => "saltelli"
  "samplesize" => 10000
  "mes"        => OrderedCollections.OrderedDict("o1"=>OrderedCollections.Order…
  "tes"        => OrderedCollections.OrderedDict("o1"=>OrderedCollections.Order…
  "seed"       => 2016
  "var"        => OrderedCollections.OrderedDict("o1"=>OrderedCollections.Order…
\end{Verbatim}
\end{tcolorbox}
        
    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{32}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{Mads}\PY{o}{.}\PY{n}{plotobsSAresults}\PY{p}{(}\PY{n}{md}\PY{p}{,} \PY{n}{saltelli\PYZus{}results}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{model_diagnostics_files/model_diagnostics_69_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{model_diagnostics_files/model_diagnostics_69_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{model_diagnostics_files/model_diagnostics_69_3.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{model_diagnostics_files/model_diagnostics_69_4.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]

    \end{Verbatim}

    The EFAST results are obtained as follows:

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{33}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{efastresult} \PY{o}{=} \PY{n}{Mads}\PY{o}{.}\PY{n}{efast}\PY{p}{(}\PY{n}{md}\PY{p}{,} \PY{n}{N}\PY{o}{=}\PY{l+m+mi}{1000}\PY{p}{,} \PY{n}{seed}\PY{o}{=}\PY{l+m+mi}{2016}\PY{p}{)}
\PY{n}{Mads}\PY{o}{.}\PY{n}{plotobsSAresults}\PY{p}{(}\PY{n}{md}\PY{p}{,} \PY{n}{efastresult}\PY{p}{,} \PY{n}{filename}\PY{o}{=}\PY{l+s}{\PYZdq{}}\PY{l+s}{sensitivity\PYZus{}efast.png}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{n}{xtitle} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{Time [\PYZhy{}]}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{n}{ytitle} \PY{o}{=} \PY{l+s}{\PYZdq{}}\PY{l+s}{Observation [\PYZhy{}]}\PY{l+s}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{model_diagnostics_files/model_diagnostics_71_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{model_diagnostics_files/model_diagnostics_71_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{model_diagnostics_files/model_diagnostics_71_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{model_diagnostics_files/model_diagnostics_71_4.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]

    \end{Verbatim}

    The difference in the \texttt{total} and \texttt{main} effect plots
suggest correlations in the model parameters (which is also demonstrated
by the \texttt{AffineInvariantMCMC} analyses above).

The figures also demonstrate that the parameter sensitivity to
observations changes over time.

Based on the \texttt{total\ effect}, parameter \texttt{a} and \texttt{n}
sensitivities generally increase with time. Parameter \texttt{b} and
\texttt{b} sensitivities generally decrease with time.

    \hypertarget{decision-analysis-using-information-gap-decision-theory}{%
\subsection{Decision Analysis using Information-Gap Decision
Theory}\label{decision-analysis-using-information-gap-decision-theory}}

Define the Information-Gap Decision Theory horizons of uncertainty
\texttt{h}:

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{34}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{h} \PY{o}{=} \PY{p}{[}\PY{l+m+mf}{0.001}\PY{p}{,} \PY{l+m+mf}{0.01}\PY{p}{,} \PY{l+m+mf}{0.02}\PY{p}{,} \PY{l+m+mf}{0.05}\PY{p}{,} \PY{l+m+mf}{0.1}\PY{p}{,} \PY{l+m+mf}{0.2}\PY{p}{,} \PY{l+m+mf}{0.5}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{34}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
8-element Vector\{Float64\}:
 0.001
 0.01
 0.02
 0.05
 0.1
 0.2
 0.5
 1.0
\end{Verbatim}
\end{tcolorbox}
        
    Define the polynomial models to be explored:

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{35}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{models} \PY{o}{=} \PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{y = a * t + c}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{y = a * t\PYZca{}(1.1) + b * t + c}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{y = a * t\PYZca{}n + b * t + c}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{y = a * exp(t * n) + b * t + c}\PY{l+s}{\PYZdq{}}\PY{p}{]}
\end{Verbatim}
\end{tcolorbox}

            \begin{tcolorbox}[breakable, size=fbox, boxrule=.5pt, pad at break*=1mm, opacityfill=0]
\prompt{Out}{outcolor}{35}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
4-element Vector\{String\}:
 "y = a * t + c"
 "y = a * t\^{}(1.1) + b * t + c"
 "y = a * t\^{}n + b * t + c"
 "y = a * exp(t * n) + b * t + c"
\end{Verbatim}
\end{tcolorbox}
        
    Execute the infogap analyses, collect the obtained results, and produce
a figure summarizing the results:

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{36}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{import} \PY{n}{Gadfly}
\PY{k}{import} \PY{n}{Colors}
\PY{n}{lmin} \PY{o}{=} \PY{k+kt}{Vector}\PY{p}{\PYZob{}}\PY{k+kt}{Any}\PY{p}{\PYZcb{}}\PY{p}{(}\PY{n+nb}{undef}\PY{p}{,} \PY{l+m+mi}{4}\PY{p}{)}
\PY{n}{lmax} \PY{o}{=} \PY{k+kt}{Vector}\PY{p}{\PYZob{}}\PY{k+kt}{Any}\PY{p}{\PYZcb{}}\PY{p}{(}\PY{n+nb}{undef}\PY{p}{,} \PY{l+m+mi}{4}\PY{p}{)}
\PY{n}{colors} \PY{o}{=} \PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{blue}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{red}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{green}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{orange}\PY{l+s}{\PYZdq{}}\PY{p}{]}
\PY{k}{for} \PY{n}{i} \PY{o}{=} \PY{l+m+mi}{1}\PY{o}{:}\PY{l+m+mi}{4}
	\PY{n}{min}\PY{p}{,} \PY{n}{max} \PY{o}{=} \PY{n}{Mads}\PY{o}{.}\PY{n}{infogap\PYZus{}jump\PYZus{}polynomial}\PY{p}{(}\PY{n}{model}\PY{o}{=}\PY{n}{i}\PY{p}{,} \PY{n}{plot}\PY{o}{=}\PY{n+nb}{true}\PY{p}{,} \PY{n}{horizons}\PY{o}{=}\PY{n}{h}\PY{p}{,} \PY{n}{retries}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{,} \PY{n}{maxiter}\PY{o}{=}\PY{l+m+mi}{1000}\PY{p}{,} \PY{n}{verbosity}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{seed}\PY{o}{=}\PY{l+m+mi}{2015}\PY{p}{)}
	\PY{n}{lmin}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{=} \PY{n}{Gadfly}\PY{o}{.}\PY{n}{layer}\PY{p}{(}\PY{n}{x}\PY{o}{=}\PY{n}{min}\PY{p}{,} \PY{n}{y}\PY{o}{=}\PY{n}{h}\PY{p}{,} \PY{n}{Gadfly}\PY{o}{.}\PY{n}{Geom}\PY{o}{.}\PY{n}{line}\PY{p}{,} \PY{n}{Gadfly}\PY{o}{.}\PY{n}{Theme}\PY{p}{(}\PY{n}{line\PYZus{}width}\PY{o}{=}\PY{l+m+mi}{2}\PY{n}{Gadfly}\PY{o}{.}\PY{n}{pt}\PY{p}{,} \PY{n}{line\PYZus{}style}\PY{o}{=}\PY{p}{[}\PY{l+s+ss}{:dash}\PY{p}{]}\PY{p}{,} \PY{n}{default\PYZus{}color}\PY{o}{=}\PY{n}{Base}\PY{o}{.}\PY{n}{parse}\PY{p}{(}\PY{n}{Colors}\PY{o}{.}\PY{n}{Colorant}\PY{p}{,} \PY{n}{colors}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}\PY{p}{)}\PY{p}{)}
	\PY{n}{lmax}\PY{p}{[}\PY{n}{i}\PY{p}{]} \PY{o}{=} \PY{n}{Gadfly}\PY{o}{.}\PY{n}{layer}\PY{p}{(}\PY{n}{x}\PY{o}{=}\PY{n}{max}\PY{p}{,} \PY{n}{y}\PY{o}{=}\PY{n}{h}\PY{p}{,} \PY{n}{Gadfly}\PY{o}{.}\PY{n}{Geom}\PY{o}{.}\PY{n}{line}\PY{p}{,} \PY{n}{Gadfly}\PY{o}{.}\PY{n}{Theme}\PY{p}{(}\PY{n}{line\PYZus{}width}\PY{o}{=}\PY{l+m+mi}{2}\PY{n}{Gadfly}\PY{o}{.}\PY{n}{pt}\PY{p}{,} \PY{n}{line\PYZus{}style}\PY{o}{=}\PY{p}{[}\PY{l+s+ss}{:solid}\PY{p}{]}\PY{p}{,} \PY{n}{default\PYZus{}color}\PY{o}{=}\PY{n}{Base}\PY{o}{.}\PY{n}{parse}\PY{p}{(}\PY{n}{Colors}\PY{o}{.}\PY{n}{Colorant}\PY{p}{,} \PY{n}{colors}\PY{p}{[}\PY{n}{i}\PY{p}{]}\PY{p}{)}\PY{p}{)}\PY{p}{)}
\PY{k}{end}
\PY{n}{f} \PY{o}{=} \PY{n}{Gadfly}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{lmin}\PY{o}{...}\PY{p}{,} \PY{n}{lmax}\PY{o}{...}\PY{p}{,} \PY{n}{Gadfly}\PY{o}{.}\PY{n}{Guide}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{o5}\PY{l+s}{\PYZdq{}}\PY{p}{)}\PY{p}{,} \PY{n}{Gadfly}\PY{o}{.}\PY{n}{Guide}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{Horizon of uncertainty}\PY{l+s}{\PYZdq{}}\PY{p}{)}\PY{p}{,} \PY{n}{Gadfly}\PY{o}{.}\PY{n}{Guide}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{Opportuneness vs. Robustness}\PY{l+s}{\PYZdq{}}\PY{p}{)}\PY{p}{,} \PY{n}{Gadfly}\PY{o}{.}\PY{n}{Theme}\PY{p}{(}\PY{n}{highlight\PYZus{}width}\PY{o}{=}\PY{l+m+mi}{0}\PY{n}{Gadfly}\PY{o}{.}\PY{n}{pt}\PY{p}{)}\PY{p}{,} \PY{n}{Gadfly}\PY{o}{.}\PY{n}{Guide}\PY{o}{.}\PY{n}{manual\PYZus{}color\PYZus{}key}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{Models}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{n}{models}\PY{p}{,} \PY{n}{colors}\PY{p}{)}\PY{p}{)}
\PY{n}{Gadfly}\PY{o}{.}\PY{n}{draw}\PY{p}{(}\PY{n}{Gadfly}\PY{o}{.}\PY{n}{PNG}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{infogap\PYZus{}opportuneness\PYZus{}vs\PYZus{}robustness.png}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{l+m+mi}{6}\PY{n}{Gadfly}\PY{o}{.}\PY{n}{inch}\PY{p}{,} \PY{l+m+mi}{4}\PY{n}{Gadfly}\PY{o}{.}\PY{n}{inch}\PY{p}{)}\PY{p}{,} \PY{n}{f}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{Verbatim}[commandchars=\\\{\}]
┌ Info: New seed: 2015
└ @ Mads /Users/vvv/.julia/dev/Mads/src/MadsHelpers.jl:462
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]

******************************************************************************
This program contains Ipopt, a library for large-scale nonlinear optimization.
 Ipopt is released as open source code under the Eclipse Public License (EPL).
         For more information visit https://github.com/coin-or/Ipopt
******************************************************************************

Min h = 0.001 OF = 4.998333281688344 par = [0.9993333197989149,
0.0016666826937701167]
Max h = 0.001 OF = 5.00166671833499 par = [1.0006666802044195,
-0.001666682687108125]
Min h = 0.01 OF = 4.983333280036714 par = [0.9933333177282005,
0.016666691395710947]
Max h = 0.01 OF = 5.016666718990943 par = [1.0066666807443947,
-0.016666684731030848]
Min h = 0.02 OF = 4.966666614342419 par = [0.9866666521256426,
0.033333353714205226]
Max h = 0.02 OF = 5.033333387019943 par = [1.0133333489146892,
-0.03333335755350352]
Min h = 0.05 OF = 4.916666615311706 par = [0.9666666528982734,
0.08333335082033852]
Max h = 0.05 OF = 5.08333338580072 par = [1.0333333472115793,
-0.08333335025717689]
Min h = 0.1 OF = 4.833333282661476 par = [0.9333333197717608,
0.16666668380267258]
Max h = 0.1 OF = 5.166666719675405 par = [1.0666666805654965,
-0.16666668315207778]
Min h = 0.2 OF = 4.666666617013978 par = [0.8666666531305123, 0.333333351361417]
Max h = 0.2 OF = 5.3333333876552285 par = [1.133333347539164,
-0.3333333500405913]
Min h = 0.5 OF = 4.166666620015298 par = [0.666666653134728, 0.8333333543416581]
Max h = 0.5 OF = 5.8333333916516725 par = [1.3333333485322296,
-0.8333333510094758]
Min h = 1.0 OF = 3.333333291678896 par = [0.33333331979902153,
1.666666692683788]
Max h = 1.0 OF = 6.66666673165455 par = [1.6666666835343882, -1.666666686017392]
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
┌ Info: New seed: 2015
└ @ Mads /Users/vvv/.julia/dev/Mads/src/MadsHelpers.jl:462
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
Min h = 0.001 OF = 4.9960744454905965 par = [-0.03655198917957378,
1.0437989392240055, -0.008246956140052745]
Max h = 0.001 OF = 5.003925554522909 par = [0.036551989057392965,
0.9562010609257169, 0.008246956122525443]
Min h = 0.01 OF = 4.960745363330646 par = [-0.36551410869632334,
1.437982560318741, -0.08246845805988594]
Max h = 0.01 OF = 5.039254636799261 par = [0.3655141073877924,
0.5620174412841543, 0.08246845786044212]
Min h = 0.02 OF = 4.921490828175631 par = [-0.731027566617381,
1.8759643517308704, -0.16493679213714782]
Max h = 0.02 OF = 5.078509171873495 par = [0.7310275550438009,
0.12403566252037508, 0.1649367889027792]
Min h = 0.05 OF = 4.803727222947509 par = [-1.8275679184585027,
3.1899096986947266, -0.41234178651963727]
Max h = 0.05 OF = 5.196272777724391 par = [1.8275679123567241,
-1.189909691219638, 0.41234178565241686]
Min h = 0.1 OF = 4.607454547104612 par = [-3.6551351873746936,
5.379818629776438, -0.8246834485881221]
Max h = 0.1 OF = 5.392545454245484 par = [3.655135175083979,
-3.3798186147139266, 0.824683446810193]
Min h = 0.2 OF = 4.214909194737556 par = [-7.310269737140044, 9.759636506472651,
-1.64936677598685]
Max h = 0.2 OF = 5.7850908074455605 par = [7.3102697046759735,
-7.759636466764177, 1.6493667702921515]
Min h = 0.5 OF = 3.591684039656965 par = [-7.751158513274632,
10.000000041783382, -0.8850280664081923]
Max h = 0.5 OF = 6.49427721194079 par = [9.382981348214942, -10.000000044037646,
1.3871392608548654]
Min h = 1.0 OF = 2.6876583975888058 par = [-8.067223019985045,
10.000000062883482, 0.0672229701222594]
Max h = 1.0 OF = 7.44592953417183 par = [9.736303636511739, -10.000000065441785,
0.26369642586347747]
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
┌ Info: New seed: 2015
└ @ Mads /Users/vvv/.julia/dev/Mads/src/MadsHelpers.jl:462
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
Min h = 0.001 OF = 4.993999809993968 par = [-0.0001250040451789784,
1.0026250655869564, -0.0035000665302511625, 2.999997843315674]
Max h = 0.001 OF = 5.006000200041004 par = [0.00012500374313672267,
0.997374931285495, 0.0035000749793720805, 3.000000029507715]
Min h = 0.01 OF = 4.939999809729828 par = [-0.0012500039848518721,
1.0262500653481148, -0.03500006635146049, 2.999999811324717]
Max h = 0.01 OF = 5.060000190420172 par = [0.0012500039827685484,
0.9737499347289683, 0.035000066376460574, 2.9999998113247166]
Min h = 0.02 OF = 4.879999809436044 par = [-0.002500003917827296,
1.0525000650829668, -0.07000006615333457, 2.9999999206621957]
Max h = 0.02 OF = 5.120000190863952 par = [0.002500003913660588,
0.9474999350712004, 0.0700000662033339, 2.9999999206621952]
Min h = 0.05 OF = 4.699999809110879 par = [-0.006250003705588852,
1.1312500640011731, -0.17500006484468256, 2.9999999863618134]
Max h = 0.05 OF = 5.300000191636143 par = [0.006250003695269465,
0.8687499363840293, 0.1750000649694136, 2.99999998635084]
Min h = 0.1 OF = 4.399999807272094 par = [-0.012500003374736784,
1.2625000628015948, -0.35000006419023805, 3.000000008232852]
Max h = 0.1 OF = 5.600000194228184 par = [0.012500003353865882,
0.7374999379699614, 0.35000006443880427, 3.0000000082339633]
Min h = 0.2 OF = 3.7999998042537553 par = [-0.025000002708412933,
1.5250000602396283, -0.700000062415874, 3.000000019082813]
Max h = 0.2 OF = 6.20000019874704 par = [0.02500000266667985,
0.47499994130280493, 0.7000000629146885, 3.0000000190840956]
Min h = 0.5 OF = 1.999999795385952 par = [-0.06250000069969568,
2.3125000523306776, -1.7500000565793346, 3.000000025626925]
Max h = 0.5 OF = 8.000000212115324 par = [0.0625000005955181,
-0.31250004847656593, 1.7500000578296342, 3.0000000256271333]
Min h = 1.0 OF = -1.0000002193334967 par = [-0.12499999734956149,
3.625000039098136, -3.5000000467297627, 3.000000027811915]
Max h = 1.0 OF = 11.000000234333372 par = [0.12499999714118018,
-1.6250000313891586, 3.5000000492286207, 3.000000027812066]
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
┌ Info: New seed: 2015
└ @ Mads /Users/vvv/.julia/dev/Mads/src/MadsHelpers.jl:462
    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
Min h = 0.001 OF = 4.93820509022155 par = [-1.991956463987334e-8,
1.001080524737567, -0.0020801343866858023, 2.9999999883894968]
Max h = 0.001 OF = 5.061794919720368 par = [1.991956366528757e-8,
0.9989194750922847, 0.002080134822476713, 3.000000029984543]
Min h = 0.01 OF = 4.382067676125225 par = [-1.9919025980225499e-7,
1.0108050472181263, -0.020801056118970217, 3.0000000258388377]
Max h = 0.01 OF = 5.617932323094888 par = [1.991902594702715e-7,
0.9891949528332155, 0.020801056167635203, 3.0000000258388377]
Min h = 0.02 OF = 3.7641372160181787 par = [-3.9837992109379617e-7,
1.0216100721965256, -0.0416020802659529, 3.0000000279194157]
Max h = 0.02 OF = 6.23586278242203 par = [3.983799204298235e-7,
0.9783899279061579, 0.041602080363282834, 3.0000000279194157]
Min h = 0.05 OF = 1.9103458356971257 par = [-9.959489049683935e-7,
1.0540251471317235, -0.10400515270690125, 3.0000000291677655]
Max h = 0.05 OF = 8.089654160403452 par = [9.959489033084791e-7,
0.945974853124985, 0.1040051529502259, 3.0000000291677655]
Min h = 0.1 OF = -1.1793064329087564 par = [-1.9918972144258892e-6,
1.1080502714651672, -0.20801027206863687, 3.000000028258382]
Max h = 0.1 OF = 11.179306457039136 par = [1.9918972081062344e-6,
0.8919497284896971, 0.2080102739284642, 3.0000000295838825]
Min h = 0.2 OF = -7.358611065908197 par = [-3.983793824341401e-6,
1.2161005218077126, -0.41602051491164094, 3.000000029791941]
Max h = 0.2 OF = 17.35861105031053 par = [3.98379381770175e-6,
0.7838994792191215, 0.41602051588494027, 3.000000029791941]
Min h = 0.5 OF = -25.896488521674833 par = [-9.959487073347952e-6,
1.5402506350898875, -1.0400496755102369, 2.999999728223722]
Max h = 0.5 OF = 35.896523990350396 par = [9.959483725387019e-6,
0.4597487460979546, 1.040051205638272, 3.000000022944347]
Min h = 1.0 OF = -56.79304787447036 par = [-1.9918966727663864e-5,
2.0805025200796528, -2.0801024466702493, 3.0000000299583918]
Max h = 1.0 OF = 66.79304780650143 par = [1.9918966693524435e-5,
-0.08050251512076644, 2.080102451967674, 3.0000000299999843]
    \end{Verbatim}

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{37}{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{Mads}\PY{o}{.}\PY{n}{display}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{infogap\PYZus{}opportuneness\PYZus{}vs\PYZus{}robustness.png}\PY{l+s}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{model_diagnostics_files/model_diagnostics_79_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]

    \end{Verbatim}

    The figure above compares the model \texttt{opportuneness} (dashed
lines) vs model \texttt{robustness} (solid lines) for different infogap
horizons of uncertainty \texttt{h} and different models (different
colors).

The model \texttt{opportuneness} defines that the things might get
better than expected (i.e., observation at dimensionless time 5
\texttt{o5} can get lower than expected).

The model \texttt{robustness} defines that things might get worse than
expected (i.e., observation at dimensionless time 5 \texttt{o5} can get
higher than expected).

Based on both the model \texttt{opportuneness} and model
\texttt{robustness}, the last model is the most complex and can bring
the most surprises. The first model is the simplest and produces the
lower level of surprises.

In terms of model selection, the simplest model is the best. However,
the alternative models (if they capture all the conceptual model
uncertainties) represent how much things can get worse/better within the
horizon of uncertainty.


    % Add a bibliography block to the postdoc
    
    
    
\end{document}
