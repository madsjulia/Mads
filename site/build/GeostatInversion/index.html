



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Model Analysis and Decision Support">
      
      
        <link rel="canonical" href="http://madsjulia.github.io/Mads.jl/build/GeostatInversion/">
      
      
        <meta name="author" content="Velimir monty Vesselinov">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-3.1.0">
    
    
      
        <title>GeostatInversion - MADS</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.11e41852.css">
      
      
    
    
      <script src="../../assets/javascripts/modernizr.20ef595d.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../../assets/fonts/material-icons.css">
    
    
      <link rel="stylesheet" href="../../assets/Documenter.css">
    
    
  </head>
  
    <body dir="ltr">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="__github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#geostatinversionjl" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="http://madsjulia.github.io/Mads.jl" title="MADS" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                MADS
              </span>
              <span class="md-header-nav__topic">
                GeostatInversion
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="https://github.com/madsjulia/Mads.jl/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      GitHub
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="http://madsjulia.github.io/Mads.jl" title="MADS" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    MADS
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="https://github.com/madsjulia/Mads.jl/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#__github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      GitHub
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../installation/" title="Installation" class="md-nav__link">
      Installation
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../getting_started/" title="Getting started" class="md-nav__link">
      Getting started
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Examples
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Examples
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Examples/setup/" title="Setup" class="md-nav__link">
      Setup
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Examples/bigdt/source_termination/" title="Decision Analysis" class="md-nav__link">
      Decision Analysis
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Examples/infogap/" title="Information Gap Analysis" class="md-nav__link">
      Information Gap Analysis
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Examples/bayesian_sampling/" title="Bayesian Sampling" class="md-nav__link">
      Bayesian Sampling
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Examples/blind_source_separation/" title="Blind Source Separation" class="md-nav__link">
      Blind Source Separation
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Examples/contamination/" title="Contaminant Transport" class="md-nav__link">
      Contaminant Transport
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Examples/ode/" title="ODE Analysis" class="md-nav__link">
      ODE Analysis
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../Notebooks/" title="Notebooks" class="md-nav__link">
      Notebooks
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../Examples/" title="Examples Links" class="md-nav__link">
      Examples Links
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../model_coupling/" title="Model Coupling" class="md-nav__link">
      Model Coupling
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../test/" title="Testing & Verification" class="md-nav__link">
      Testing & Verification
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../functions/" title="Functions" class="md-nav__link">
      Functions
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-10" type="checkbox" id="nav-10">
    
    <label class="md-nav__link" for="nav-10">
      Modules
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-10">
        Modules
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../Modules/Mads/" title="Mads" class="md-nav__link">
      Mads
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Modules/AffineInvariantMCMC/" title="AffineInvariantMCMC" class="md-nav__link">
      AffineInvariantMCMC
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Modules/Anasol/" title="Anasol" class="md-nav__link">
      Anasol
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Modules/BIGUQ/" title="BIGUQ" class="md-nav__link">
      BIGUQ
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Modules/DocumentFunction/" title="DocumentFunction" class="md-nav__link">
      DocumentFunction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Modules/GeostatInversion/" title="GeostatInversion" class="md-nav__link">
      GeostatInversion
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Modules/MetaProgTools/" title="MetaProgTools" class="md-nav__link">
      MetaProgTools
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Modules/ReusableFunctions/" title="ReusableFunctions" class="md-nav__link">
      ReusableFunctions
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Modules/RobustPmap/" title="RobustPmap" class="md-nav__link">
      RobustPmap
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../Modules/SVR/" title="SVR" class="md-nav__link">
      SVR
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../acknowledgments/" title="Acknowledgments" class="md-nav__link">
      Acknowledgments
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../../copying/" title="License" class="md-nav__link">
      License
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#module-geostatinversionfdderivatives" title="Module GeostatInversion.FDDerivatives" class="md-nav__link">
    Module GeostatInversion.FDDerivatives
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#module-geostatinversionrandmatfact" title="Module GeostatInversion.RandMatFact" class="md-nav__link">
    Module GeostatInversion.RandMatFact
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#module-geostatinversionfftrf" title="Module GeostatInversion.FFTRF" class="md-nav__link">
    Module GeostatInversion.FFTRF
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/madsjulia/Mads.jl/edit/master/docs/build/GeostatInversion.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <p><a id='GeostatInversion.jl-1'></a></p>
<h1 id="geostatinversionjl">GeostatInversion.jl</h1>
<p>This package provides methods for inverse analysis using parameter fields that are represented using geostatistical (stochastic) methods. Currently, two geostatistical methods are implemented. One is the Principal Component Geostatistical Approach (PCGA) proposed by <a href="http://dx.doi.org/10.1002/2013WR014630">Kitanidis</a> &amp; <a href="http://dx.doi.org/10.1002/2014WR015483">Lee</a>. The other utilizes a Randomized Geostatistical Approach (RGA) that builds on PCGA.</p>
<p>Randomized Geostatistical Approach (RGA) references:</p>
<ul>
<li><a href="http://adsabs.harvard.edu/abs/2015AGUFM.T31E..03O">O'Malley, D., Le, E., Vesselinov, V.V., Fast Geostatistical Inversion using Randomized Matrix Decompositions and Sketchings for Heterogeneous Aquifer Characterization, AGU Fall Meeting, San Francisco, CA, December 14–18, 2015.</a></li>
<li><a href="submitted">Lin, Y, Le, E.B, O'Malley, D., Vesselinov, V.V., Bui-Thanh, T., Large-Scale Inverse Model Analyses Employing Fast Randomized Data Reduction, 2016.</a></li>
</ul>
<p>Two versions of PCGA are implemented in this package</p>
<ul>
<li><code>pcgadirect</code>, which uses full matrices and direct solvers during iterations</li>
<li><code>pcgalsqr</code>, which uses low rank representations of the matrices combined with iterative solvers during iterations</li>
</ul>
<p>The RGA method, <code>rga</code>, can use either of these approaches using the keyword argument. That is, by doing <code>rga(...; pcgafunc=GeostatInversion.pcgadirect)</code> or <code>rga(...; pcgafunc=GeostatInversion.pcgalsqr)</code>.</p>
<p>GeostatInversion.jl module functions:</p>
<p><a id='GeostatInversion.getxis' href='#GeostatInversion.getxis'>#</a>
<strong><code>GeostatInversion.getxis</code></strong> &mdash; <em>Function</em>.</p>
<p>Get the parameter subspace that will be explored during the inverse analysis</p>
<div class="codehilite"><pre><span></span>getxis(samplefield::Function, numfields::Int, numxis::Int, p::Int, q::Int=3, seed=nothing)
getxis(Q::Matrix, numxis::Int, p::Int, q::Int=3, seed=nothing)
</pre></div>


<p>Arguments:</p>
<ul>
<li>samplefield : a function that takes no arguments and returns a sample of the field</li>
<li>Q : the covariance matrix of the parameter field</li>
<li>numfields : the number of fields that will be used to find the subspace</li>
<li>numxis : the dimension of the subspace</li>
<li>p : oversampling parameter when estimating the range of the covariance matrix (see Halko et al, SIAM Rev., 2011)</li>
<li>q : number of power iterations when estimating the range of the covariance matrix (see Halko et al, SIAM Rev., 2011)</li>
<li>seed : an optional seed to use when doing the randomized matrix factorization</li>
</ul>
<p><a target='_blank' href='https://github.com/madsjulia/GeostatInversion.jl/blob/bd6082be4393cfd5b6c6f59ee55524b1dbd74e8e/src/GeostatInversion.jl#L37-L54' class='documenter-source'>source</a><br></p>
<p><a id='GeostatInversion.pcgadirect-Tuple{Function,Array{T,1} where T,Array{T,1} where T,Array{Array{Float64,1},1},Any,Array{T,1} where T}' href='#GeostatInversion.pcgadirect-Tuple{Function,Array{T,1} where T,Array{T,1} where T,Array{Array{Float64,1},1},Any,Array{T,1} where T}'>#</a>
<strong><code>GeostatInversion.pcgadirect</code></strong> &mdash; <em>Method</em>.</p>
<p>Direct principal component geostatistical approach</p>
<div class="codehilite"><pre><span></span><span class="nt">pcgadirect</span><span class="o">(</span><span class="nt">forwardmodel</span><span class="p">::</span><span class="nd">Function</span><span class="o">,</span> <span class="nt">s0</span><span class="p">::</span><span class="nd">Vector</span><span class="o">,</span> <span class="nt">X</span><span class="p">::</span><span class="nd">Vector</span><span class="o">,</span> <span class="nt">xis</span><span class="p">::</span><span class="nd">Array</span><span class="p">{</span><span class="err">Array{Float64,</span> <span class="err">1</span><span class="p">}</span><span class="o">,</span> <span class="nt">1</span><span class="err">}</span><span class="o">,</span> <span class="nt">R</span><span class="o">,</span> <span class="nt">y</span><span class="p">::</span><span class="nd">Vector</span><span class="o">;</span> <span class="nt">maxiters</span><span class="p">::</span><span class="nd">Int</span><span class="o">=</span><span class="nt">5</span><span class="o">,</span> <span class="nt">delta</span><span class="p">::</span><span class="nd">Float64</span><span class="o">=</span><span class="nt">sqrt</span><span class="o">(</span><span class="nt">eps</span><span class="o">(</span><span class="nt">Float64</span><span class="o">)),</span> <span class="nt">xtol</span><span class="p">::</span><span class="nd">Float64</span><span class="o">=</span><span class="nt">1e-6</span><span class="o">,</span> <span class="nt">callback</span><span class="o">=(</span><span class="nt">s</span><span class="o">,</span> <span class="nt">obs_cal</span><span class="o">)</span><span class="nt">-</span><span class="o">&gt;</span><span class="nt">nothing</span><span class="o">)</span>
</pre></div>


<p>Arguments:</p>
<ul>
<li>forwardmodel : param to obs map h(s)</li>
<li>s0 : initial guess</li>
<li>X : mean of parameter prior (replace with B*X drift matrix later for p&gt;1)</li>
<li>xis : K columns of Z = randSVDzetas(Q,K,p,q) where Q is the parameter covariance matrix</li>
<li>R : covariance of measurement error (data misfit term)</li>
<li>y : data vector</li>
<li>maxiters : maximum # of PCGA iterations</li>
<li>delta : the finite difference step size</li>
<li>xtol : convergence tolerence for the parameters</li>
<li>callback : a function of the form <code>(params, observations)-&gt;...</code> that is called during each iteration</li>
</ul>
<p><a target='_blank' href='https://github.com/madsjulia/GeostatInversion.jl/blob/bd6082be4393cfd5b6c6f59ee55524b1dbd74e8e/src/direct.jl#L1-L20' class='documenter-source'>source</a><br></p>
<p><a id='GeostatInversion.pcgalsqr-Tuple{Function,Array{T,1} where T,Array{T,1} where T,Array{Array{Float64,1},1},Any,Array{T,1} where T}' href='#GeostatInversion.pcgalsqr-Tuple{Function,Array{T,1} where T,Array{T,1} where T,Array{Array{Float64,1},1},Any,Array{T,1} where T}'>#</a>
<strong><code>GeostatInversion.pcgalsqr</code></strong> &mdash; <em>Method</em>.</p>
<p>Iterative principal component geostatistical approach</p>
<div class="codehilite"><pre><span></span><span class="nt">pcgalsqr</span><span class="o">(</span><span class="nt">forwardmodel</span><span class="p">::</span><span class="nd">Function</span><span class="o">,</span> <span class="nt">s0</span><span class="p">::</span><span class="nd">Vector</span><span class="o">,</span> <span class="nt">X</span><span class="p">::</span><span class="nd">Vector</span><span class="o">,</span> <span class="nt">xis</span><span class="p">::</span><span class="nd">Array</span><span class="p">{</span><span class="err">Array{Float64,</span> <span class="err">1</span><span class="p">}</span><span class="o">,</span> <span class="nt">1</span><span class="err">}</span><span class="o">,</span> <span class="nt">R</span><span class="o">,</span> <span class="nt">y</span><span class="p">::</span><span class="nd">Vector</span><span class="o">;</span> <span class="nt">maxiters</span><span class="p">::</span><span class="nd">Int</span><span class="o">=</span><span class="nt">5</span><span class="o">,</span> <span class="nt">delta</span><span class="p">::</span><span class="nd">Float64</span><span class="o">=</span><span class="nt">sqrt</span><span class="o">(</span><span class="nt">eps</span><span class="o">(</span><span class="nt">Float64</span><span class="o">)),</span> <span class="nt">xtol</span><span class="p">::</span><span class="nd">Float64</span><span class="o">=</span><span class="nt">1e-6</span><span class="o">)</span>
</pre></div>


<p>Arguments:</p>
<ul>
<li>forwardmodel : param to obs map h(s)</li>
<li>s0 : initial guess</li>
<li>X : mean of parameter prior (replace with B*X drift matrix later for p&gt;1)</li>
<li>xis : K columns of Z = randSVDzetas(Q,K,p,q) where Q is the parameter covariance matrix</li>
<li>R : covariance of measurement error (data misfit term)</li>
<li>y : data vector</li>
<li>maxiters : maximum # of PCGA iterations</li>
<li>delta : the finite difference step size</li>
<li>xtol : convergence tolerence for the parameters</li>
</ul>
<p><a target='_blank' href='https://github.com/madsjulia/GeostatInversion.jl/blob/bd6082be4393cfd5b6c6f59ee55524b1dbd74e8e/src/lsqr.jl#L1-L19' class='documenter-source'>source</a><br></p>
<p><a id='GeostatInversion.rga-Tuple{Function,Array{T,1} where T,Array{T,1} where T,Array{Array{Float64,1},1},Any,Array{T,1} where T,Any}' href='#GeostatInversion.rga-Tuple{Function,Array{T,1} where T,Array{T,1} where T,Array{Array{Float64,1},1},Any,Array{T,1} where T,Any}'>#</a>
<strong><code>GeostatInversion.rga</code></strong> &mdash; <em>Method</em>.</p>
<p>Randomized (principal component) geostatistical approach</p>
<p>Example:</p>
<div class="codehilite"><pre><span></span><span class="kd">function</span> <span class="nx">rga</span><span class="p">(</span><span class="nx">forwardmodel</span><span class="o">::</span><span class="nb">Function</span><span class="p">,</span> <span class="nx">s0</span><span class="o">::</span><span class="nx">Vector</span><span class="p">,</span> <span class="nx">X</span><span class="o">::</span><span class="nx">Vector</span><span class="p">,</span> <span class="nx">xis</span><span class="o">::</span><span class="nb">Array</span><span class="p">{</span><span class="nb">Array</span><span class="p">{</span><span class="nx">Float64</span><span class="p">,</span> <span class="mi">1</span><span class="p">},</span> <span class="mi">1</span><span class="p">},</span> <span class="nx">R</span><span class="p">,</span> <span class="nx">y</span><span class="o">::</span><span class="nx">Vector</span><span class="p">,</span> <span class="nx">S</span><span class="p">;</span> <span class="nx">maxiters</span><span class="o">::</span><span class="nx">Int</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="nx">delta</span><span class="o">::</span><span class="nx">Float64</span><span class="o">=</span><span class="nx">sqrt</span><span class="p">(</span><span class="nx">eps</span><span class="p">(</span><span class="nx">Float64</span><span class="p">)),</span> <span class="nx">xtol</span><span class="o">::</span><span class="nx">Float64</span><span class="o">=</span><span class="mi">1</span><span class="nx">e</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="nx">pcgafunc</span><span class="o">=</span><span class="nx">pcgadirect</span><span class="p">,</span> <span class="nx">callback</span><span class="o">=</span><span class="p">(</span><span class="nx">s</span><span class="p">,</span> <span class="nx">obs_cal</span><span class="p">)</span><span class="o">-&gt;</span><span class="nx">nothing</span><span class="p">)</span>
</pre></div>


<p>Arguments:</p>
<ul>
<li>forwardmodel : param to obs map h(s)</li>
<li>s0 : initial guess</li>
<li>X : mean of parameter prior (replace with B*X drift matrix later for p&gt;1)</li>
<li>xis : K columns of Z = randSVDzetas(Q,K,p,q) where Q is the parameter covariance matrix</li>
<li>R : covariance of measurement error (data misfit term)</li>
<li>y : data vector</li>
<li>S : sketching matrix</li>
<li>maxiters : maximum # of PCGA iterations</li>
<li>delta : the finite difference step size</li>
<li>xtol : convergence tolerance for the parameters</li>
<li>callback : a function of the form <code>(params, observations)-&gt;...</code> that is called during each iteration</li>
</ul>
<p><a target='_blank' href='https://github.com/madsjulia/GeostatInversion.jl/blob/bd6082be4393cfd5b6c6f59ee55524b1dbd74e8e/src/GeostatInversion.jl#L75-L97' class='documenter-source'>source</a><br></p>
<p><a id='Module-GeostatInversion.FDDerivatives-1'></a></p>
<h2 id="module-geostatinversionfdderivatives">Module GeostatInversion.FDDerivatives</h2>
<p>GeostatInversion.FDDerivatives module functions:</p>
<p><a id='GeostatInversion.FDDerivatives.makegradient' href='#GeostatInversion.FDDerivatives.makegradient'>#</a>
<strong><code>GeostatInversion.FDDerivatives.makegradient</code></strong> &mdash; <em>Function</em>.</p>
<p>Create Gradient function</p>
<p><a target='_blank' href='https://github.com/madsjulia/GeostatInversion.jl/blob/bd6082be4393cfd5b6c6f59ee55524b1dbd74e8e/src/FDDerivatives.jl#L22' class='documenter-source'>source</a><br></p>
<p><a id='GeostatInversion.FDDerivatives.makejacobian' href='#GeostatInversion.FDDerivatives.makejacobian'>#</a>
<strong><code>GeostatInversion.FDDerivatives.makejacobian</code></strong> &mdash; <em>Function</em>.</p>
<p>Create Jacobian function</p>
<p><a target='_blank' href='https://github.com/madsjulia/GeostatInversion.jl/blob/bd6082be4393cfd5b6c6f59ee55524b1dbd74e8e/src/FDDerivatives.jl#L3' class='documenter-source'>source</a><br></p>
<p><a id='Module-GeostatInversion.RandMatFact-1'></a></p>
<h2 id="module-geostatinversionrandmatfact">Module GeostatInversion.RandMatFact</h2>
<p>GeostatInversion.RandMatFact module functions:</p>
<p><a id='GeostatInversion.RandMatFact.randsvd-Tuple{Any,Int64,Int64,Int64}' href='#GeostatInversion.RandMatFact.randsvd-Tuple{Any,Int64,Int64,Int64}'>#</a>
<strong><code>GeostatInversion.RandMatFact.randsvd</code></strong> &mdash; <em>Method</em>.</p>
<p>Random SVD based on algorithm 5.1 from Halko et al.</p>
<p><a target='_blank' href='https://github.com/madsjulia/GeostatInversion.jl/blob/bd6082be4393cfd5b6c6f59ee55524b1dbd74e8e/src/RandMatFact.jl#L75' class='documenter-source'>source</a><br></p>
<p><a id='Module-GeostatInversion.FFTRF-1'></a></p>
<h2 id="module-geostatinversionfftrf">Module GeostatInversion.FFTRF</h2>
<p>GeostatInversion.FFTRF module functions:</p>
<p><a id='GeostatInversion.FFTRF.reducek-Union{Tuple{Any,Type{Val{N}}}, Tuple{N}} where N' href='#GeostatInversion.FFTRF.reducek-Union{Tuple{Any,Type{Val{N}}}, Tuple{N}} where N'>#</a>
<strong><code>GeostatInversion.FFTRF.reducek</code></strong> &mdash; <em>Method</em>.</p>
<p>Reduce k</p>
<p><a target='_blank' href='https://github.com/madsjulia/GeostatInversion.jl/blob/bd6082be4393cfd5b6c6f59ee55524b1dbd74e8e/src/FFTRF.jl#L6' class='documenter-source'>source</a><br></p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.9e1f3b71.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"../.."}})</script>
      
        <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>
      
    
    
      
        <script>!function(e,a,t,n,o,c,i){e.GoogleAnalyticsObject=o,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,c=a.createElement(t),i=a.getElementsByTagName(t)[0],c.async=1,c.src="https://www.google-analytics.com/analytics.js",i.parentNode.insertBefore(c,i)}(window,document,"script",0,"ga"),ga("create","UA-25717430-1","mads.lanl.gov"),ga("set","anonymizeIp",!0),ga("send","pageview");var links=document.getElementsByTagName("a");if(Array.prototype.map.call(links,function(a){a.host!=document.location.host&&a.addEventListener("click",function(){var e=a.getAttribute("data-md-action")||"follow";ga("send","event","outbound",e,a.href)})}),document.forms.search){var query=document.forms.search.query;query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})}</script>
      
    
  </body>
</html>